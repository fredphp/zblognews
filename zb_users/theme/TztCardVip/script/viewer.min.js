/*!
 * Viewer v1.0.0
 * https://github.com/fengyuanchen/viewer
 *
 * Copyright (c) 2015-2018 Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2018-04-01T06:11:06.751Z
 */
!function(f,S){"object"==typeof exports&&"undefined"!=typeof module?S(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],S):S(f.jQuery)}(this,function(f){"use strict";f=f&&f.hasOwnProperty("default")?f.default:f;var S={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,transition:!0,fullscreen:!0,interval:5e3,keyboard:!0,backdrop:!0,loading:!0,loop:!0,minWidth:200,minHeight:100,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,url:"src",container:"body",filter:null,ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null},e="undefined"!=typeof window,j=e?window:{},d="viewer",D="move",dA="switch",b="zoom",h=d+"-active",a=d+"-fade",X=d+"-fixed",c=d+"-fullscreen-exit",ab=d+"-hide",M=d+"-hide-md-down",eL=d+"-hide-sm-down",g=d+"-hide-xs-down",bd=d+"-in",J=d+"-invisible",eT=d+"-loading",fj=d+"-open",gI=d+"-show",ei=d+"-transition",fD="ready",fZ="show",cN="shown",bY="hide",eE="hidden",ed="view",gIc="viewed",dg="click",db="dragstart",O="keydown",eY="load",da=j.PointerEvent?"pointerdown":"touchstart mousedown",dR=j.PointerEvent?"pointermove":"touchmove mousemove",gV=j.PointerEvent?"pointerup pointercancel":"touchend touchcancel mouseup",gS="resize",i="transitionend",k="wheel mousewheel DOMMouseScroll",l=["zoom-in","zoom-out","one-to-one","reset","prev","play","next","rotate-left","rotate-right","flip-horizontal","flip-vertical"],m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(f){return typeof f}:function(f){return f&&"function"==typeof Symbol&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},n=function(f,S){if(!(f instanceof S))throw new TypeError("Cannot call a class as a function")},o=function(){function f(f,S){for(var e=0;e<S.length;e++){var j=S[e];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(f,j.key,j)}}return function(S,e,j){return e&&f(S.prototype,e),j&&f(S,j),S}}();function p(f){return"string"==typeof f}var q=Number.isNaN||j.isNaN;function r(f){return"number"==typeof f&&!q(f)}function s(f){return void 0===f}function t(f){return"object"===(void 0===f?"undefined":m(f))&&null!==f}var u=Object.prototype.hasOwnProperty;function v(f){if(!t(f))return!1;try{var S=f.constructor,e=S.prototype;return S&&e&&u.call(e,"isPrototypeOf")}catch(f){return!1}}function w(f){return"function"==typeof f}function x(f,S){if(f&&w(S))if(Array.isArray(f)||r(f.length)){var e=f.length,j=void 0;for(j=0;j<e&&!1!==S.call(f,f[j],j,f);j+=1);}else t(f)&&Object.keys(f).forEach(function(e){S.call(f,f[e],e,f)});return f}var y=Object.assign||function(f){for(var S=arguments.length,e=Array(1<S?S-1:0),j=1;j<S;j++)e[j-1]=arguments[j];return t(f)&&0<e.length&&e.forEach(function(S){t(S)&&Object.keys(S).forEach(function(e){f[e]=S[e]})}),f},z=/^(?:width|height|left|top|marginLeft|marginTop)$/;function A(f,S){var e=f.style;x(S,function(f,S){z.test(S)&&r(f)&&(f+="px"),e[S]=f})}function B(f,S){return f.classList?f.classList.contains(S):-1<f.className.indexOf(S)}function C(f,S){if(S)if(r(f.length))x(f,function(f){C(f,S)});else if(f.classList)f.classList.add(S);else{var e=f.className.trim();e?e.indexOf(S)<0&&(f.className=e+" "+S):f.className=S}}function E(f,S){S&&(r(f.length)?x(f,function(f){E(f,S)}):f.classList?f.classList.remove(S):0<=f.className.indexOf(S)&&(f.className=f.className.replace(S,"")))}function F(f,S,e){S&&(r(f.length)?x(f,function(f){F(f,S,e)}):e?C(f,S):E(f,S))}var G=/([a-z\d])([A-Z])/g;function H(f){return f.replace(G,"$1-$2").toLowerCase()}function I(f,S){return t(f[S])?f[S]:f.dataset?f.dataset[S]:f.getAttribute("data-"+H(S))}function K(f,S,e){t(e)?f[S]=e:f.dataset?f.dataset[S]=e:f.setAttribute("data-"+H(S),e)}var L=/\s\s*/,N=function(){var f=!1;if(e){var S=!1,d=function(){},D=Object.defineProperty({},"once",{get:function(){return f=!0,S},set:function(f){S=f}});j.addEventListener("test",d,D),j.removeEventListener("test",d,D)}return f}();function P(f,S,e){var j=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},d=e;S.trim().split(L).forEach(function(S){if(!N){var D=f.listeners;D&&D[S]&&D[S][e]&&(d=D[S][e],delete D[S][e],0===Object.keys(D[S]).length&&delete D[S],0===Object.keys(D).length&&delete f.listeners)}f.removeEventListener(S,d,j)})}function Q(f,S,e){var j=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},d=e;S.trim().split(L).forEach(function(S){if(j.once&&!N){var D=f.listeners,dA=void 0===D?{}:D;d=function(){for(var D=arguments.length,b=Array(D),h=0;h<D;h++)b[h]=arguments[h];delete dA[S][e],f.removeEventListener(S,d,j),e.apply(f,b)},dA[S]||(dA[S]={}),dA[S][e]&&f.removeEventListener(S,dA[S][e],j),dA[S][e]=d,f.listeners=dA}f.addEventListener(S,d,j)})}function R(f,S,e){var j=void 0;return w(Event)&&w(CustomEvent)?j=new CustomEvent(S,{detail:e,bubbles:!0,cancelable:!0}):(j=document.createEvent("CustomEvent")).initCustomEvent(S,!0,!0,e),f.dispatchEvent(j)}function T(f){var S=f.rotate,e=f.scaleX,j=f.scaleY,d=f.translateX,D=f.translateY,dA=[];r(d)&&0!==d&&dA.push("translateX("+d+"px)"),r(D)&&0!==D&&dA.push("translateY("+D+"px)"),r(S)&&0!==S&&dA.push("rotate("+S+"deg)"),r(e)&&1!==e&&dA.push("scaleX("+e+")"),r(j)&&1!==j&&dA.push("scaleY("+j+")");var b=dA.length?dA.join(" "):"none";return{WebkitTransform:b,msTransform:b,transform:b}}var U=j.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(j.navigator.userAgent);function V(f,S){var e=document.createElement("img");if(f.naturalWidth&&!U)return S(f.naturalWidth,f.naturalHeight),e;var j=document.body||document.documentElement;return e.onload=function(){S(e.width,e.height),U||j.removeChild(e)},e.src=f.src,U||(e.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",j.appendChild(e)),e}function W(f){switch(f){case 2:return g;case 3:return eL;case 4:return M;default:return""}}function Y(f,S){var e=f.pageX,j=f.pageY,d={endX:e,endY:j};return S?d:y({startX:e,startY:j},d)}var Z={render:function(){this.initContainer(),this.initViewer(),this.initList(),this.renderViewer()},initContainer:function(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function(){var f=this.options,S=this.parent,e=void 0;f.inline&&(e={width:Math.max(S.offsetWidth,f.minWidth),height:Math.max(S.offsetHeight,f.minHeight)},this.parentData=e),!this.fulled&&e||(e=this.containerData),this.viewerData=y({},e)},renderViewer:function(){this.options.inline&&!this.fulled&&A(this.viewer,this.viewerData)},initList:function(){var f=this,S=this.element,e=this.options,j=this.list,d=[];x(this.images,function(S,j){var D,dA=S.src,b=S.alt||(p(D=dA)?D.replace(/^.*\//,"").replace(/[?&#].*$/,""):""),h=e.url;p(h)?h=S.getAttribute(h):w(h)&&(h=h.call(f,S)),(dA||h)&&d.push('<li><img src="'+(dA||h)+'" role="button" data-action="view" data-index="'+j+'" data-original-url="'+(h||dA)+'" alt="'+b+'"></li>')}),j.innerHTML=d.join(""),this.items=j.getElementsByTagName("li"),x(this.items,function(S){var j=S.firstElementChild;K(j,"filled",!0),e.loading&&C(S,eT),Q(j,eY,function(j){e.loading&&E(S,eT),f.loadImage(j)},{once:!0})}),e.transition&&Q(S,gIc,function(){C(j,ei)},{once:!0})},renderList:function(f){var S=f||this.index,e=this.items[S].offsetWidth||30,j=e+1;A(this.list,y({width:j*this.length},T({translateX:(this.viewerData.width-e)/2-j*S})))},resetList:function(){var f=this.list;f.innerHTML="",E(f,ei),A(f,T({translateX:0}))},initImage:function(f){var S=this,e=this.options,j=this.image,d=this.viewerData,D=this.footer.offsetHeight,dA=d.width,b=Math.max(d.height-D,D),h=this.imageData||{},a=void 0;this.imageInitializing={abort:function(){a.onload=null}},a=V(j,function(j,d){var D=j/d,a=dA,X=b;S.imageInitializing=!1,dA<b*D?X=dA/D:a=b*D;var c={naturalWidth:j,naturalHeight:d,aspectRatio:D,ratio:(a=Math.min(.9*a,j))/j,width:a,height:X=Math.min(.9*X,d),left:(dA-a)/2,top:(b-X)/2},ab=y({},c);e.rotatable&&(c.rotate=h.rotate||0,ab.rotate=0),e.scalable&&(c.scaleX=h.scaleX||1,c.scaleY=h.scaleY||1,ab.scaleX=1,ab.scaleY=1),S.imageData=c,S.initialImageData=ab,f&&f()})},renderImage:function(f){var S=this,e=this.image,j=this.imageData;if(A(e,y({width:j.width,height:j.height,marginLeft:j.left,marginTop:j.top},T(j))),f)if(this.viewing&&this.options.transition){var d=function(){S.imageRendering=!1,f()};this.imageRendering={abort:function(){P(e,i,d)}},Q(e,i,d,{once:!0})}else f()},resetImage:function(){if(this.viewing||this.viewed){var f=this.image;this.viewing&&this.viewing.abort(),f.parentNode.removeChild(f),this.image=null}}},$={bind:function(){var f=this.element,S=this.viewer;Q(S,dg,this.onClick=this.click.bind(this)),Q(S,k,this.onWheel=this.wheel.bind(this)),Q(S,db,this.onDragStart=this.dragstart.bind(this)),Q(this.canvas,da,this.onPointerDown=this.pointerdown.bind(this)),Q(f.ownerDocument,dR,this.onPointerMove=this.pointermove.bind(this)),Q(f.ownerDocument,gV,this.onPointerUp=this.pointerup.bind(this)),Q(f.ownerDocument,O,this.onKeyDown=this.keydown.bind(this)),Q(window,gS,this.onResize=this.resize.bind(this))},unbind:function(){var f=this.element,S=this.viewer;P(S,dg,this.onClick),P(S,k,this.onWheel),P(S,db,this.onDragStart),P(this.canvas,da,this.onPointerDown),P(f.ownerDocument,dR,this.onPointerMove),P(f.ownerDocument,gV,this.onPointerUp),P(f.ownerDocument,O,this.onKeyDown),P(window,gS,this.onResize)}},_={click:function(f){var S=f.target,e=this.options,j=this.imageData;switch(I(S,"action")){case"mix":this.played?this.stop():e.inline?this.fulled?this.exit():this.full():this.hide();break;case"hide":this.hide();break;case"view":this.view(I(S,"index"));break;case"zoom-in":this.zoom(.1,!0);break;case"zoom-out":this.zoom(-.1,!0);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(e.loop);break;case"play":this.play(e.fullscreen);break;case"next":this.next(e.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-j.scaleX||-1);break;case"flip-vertical":this.scaleY(-j.scaleY||-1);break;default:this.played&&this.stop()}},load:function(){var f=this;this.timeout&&(clearTimeout(this.timeout),this.timeout=!1);var S=this.element,e=this.options,j=this.image,d=this.index,D=this.viewerData;E(j,J),e.loading&&E(this.canvas,eT),j.style.cssText="height:0;margin-left:"+D.width/2+"px;margin-top:"+D.height/2+"px;max-width:none!important;position:absolute;width:0;",this.initImage(function(){F(j,"viewer-move",e.movable),F(j,ei,e.transition),f.renderImage(function(){f.viewed=!0,f.viewing=!1,w(e.viewed)&&Q(S,gIc,e.viewed,{once:!0}),R(S,gIc,{originalImage:f.images[d],index:d,image:j})})})},loadImage:function(f){var S=f.target,e=S.parentNode,j=e.offsetWidth||30,d=e.offsetHeight||50,D=!!I(S,"filled");V(S,function(f,e){var dA=f/e,b=j,h=d;j<d*dA?D?b=d*dA:h=j/dA:D?h=j/dA:b=d*dA,A(S,y({width:b,height:h},T({translateX:(j-b)/2,translateY:(d-h)/2})))})},keydown:function(f){var S=this.options;if(this.fulled&&S.keyboard)switch(f.keyCode||f.which||f.charCode){case 27:this.played?this.stop():S.inline?this.fulled&&this.exit():this.hide();break;case 32:this.played&&this.stop();break;case 37:this.prev(S.loop);break;case 38:f.preventDefault(),this.zoom(S.zoomRatio,!0);break;case 39:this.next(S.loop);break;case 40:f.preventDefault(),this.zoom(-S.zoomRatio,!0);break;case 48:case 49:f.ctrlKey&&(f.preventDefault(),this.toggle())}},dragstart:function(f){"img"===f.target.tagName.toLowerCase()&&f.preventDefault()},pointerdown:function(f){var S=this.options,e=this.pointers;if(this.viewed&&!this.showing&&!this.viewing&&!this.hiding){f.changedTouches?x(f.changedTouches,function(f){e[f.identifier]=Y(f)}):e[f.pointerId||0]=Y(f);var j=!!S.movable&&D;1<Object.keys(e).length?j=b:"touch"!==f.pointerType&&"touchstart"!==f.type||!this.isSwitchable()||(j=dA),this.action=j}},pointermove:function(f){var S=this.options,e=this.pointers,j=this.action,d=this.image;this.viewed&&j&&(f.preventDefault(),f.changedTouches?x(f.changedTouches,function(f){y(e[f.identifier],Y(f,!0))}):y(e[f.pointerId||0],Y(f,!0)),j===D&&S.transition&&B(d,ei)&&E(d,ei),this.change(f))},pointerup:function(f){var S=this.action,e=this.pointers;f.changedTouches?x(f.changedTouches,function(f){delete e[f.identifier]}):delete e[f.pointerId||0],S&&(S===D&&this.options.transition&&C(this.image,ei),this.action=!1)},resize:function(){var f=this;if(this.isShown&&!this.hiding&&(this.initContainer(),this.initViewer(),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){f.renderImage()}),this.played)){if(this.options.fullscreen&&this.fulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement)return void this.stop();x(this.player.getElementsByTagName("img"),function(S){Q(S,eY,f.loadImage.bind(f),{once:!0}),R(S,eY)})}},wheel:function(f){var S=this;if(this.viewed&&(f.preventDefault(),!this.wheeling)){this.wheeling=!0,setTimeout(function(){S.wheeling=!1},50);var e=Number(this.options.zoomRatio)||.1,j=1;f.deltaY?j=0<f.deltaY?1:-1:f.wheelDelta?j=-f.wheelDelta/120:f.detail&&(j=0<f.detail?1:-1),this.zoom(-j*e,!0,f)}}},ff={show:function(){var f=0<arguments.length&&void 0!==arguments[0]&&arguments[0],S=this.element,e=this.options;if(e.inline||this.showing||this.isShown||this.showing)return this;if(!this.ready)return this.build(),this.ready&&this.show(f),this;if(w(e.show)&&Q(S,fZ,e.show,{once:!0}),!1===R(S,fZ)||!this.ready)return this;this.hiding&&this.transitioning.abort(),this.showing=!0,this.open();var j=this.viewer;if(E(j,ab),e.transition&&!f){var d=this.shown.bind(this);this.transitioning={abort:function(){P(j,i,d),E(j,bd)}},C(j,ei),j.offsetWidth,Q(j,i,d,{once:!0}),C(j,bd)}else C(j,bd),this.shown();return this},hide:function(){var f=0<arguments.length&&void 0!==arguments[0]&&arguments[0],S=this.element,e=this.options;if(e.inline||this.hiding||!this.isShown&&!this.showing)return this;if(w(e.hide)&&Q(S,bY,e.hide,{once:!0}),!1===R(S,bY))return this;this.showing&&this.transitioning.abort(),this.hiding=!0,this.played?this.stop():this.viewing&&this.viewing.abort();var j=this.viewer;if(e.transition&&!f){var d=this.hidden.bind(this),D=function(){Q(j,i,d,{once:!0}),E(j,bd)};this.transitioning={abort:function(){this.viewed?P(this.image,i,D):P(j,i,d)}},this.viewed?(Q(this.image,i,D,{once:!0}),this.zoomTo(0,!1,!1,!0)):D()}else E(j,bd),this.hidden();return this},view:function(){var f=this,S=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(S=Number(S)||0,!this.isShown)return this.index=S,this.show();if(this.hiding||this.played||S<0||S>=this.length||this.viewed&&S===this.index)return this;this.viewing&&this.viewing.abort();var e=this.element,j=this.options,d=this.title,D=this.canvas,dA=this.items[S],b=dA.querySelector("img"),a=I(b,"originalUrl"),X=b.getAttribute("alt"),c=document.createElement("img");if(c.src=a,c.alt=X,w(j.view)&&Q(e,ed,j.view,{once:!0}),!1===R(e,ed,{originalImage:this.images[S],index:S,image:c})||!this.isShown||this.hiding||this.played)return this;this.image=c,E(this.items[this.index],h),C(dA,h),this.viewed=!1,this.index=S,this.imageData={},C(c,J),j.loading&&C(D,eT),D.innerHTML="",D.appendChild(c),this.renderList(),d.innerHTML="";var ab=function(){var S=f.imageData;d.textContent=X+" ("+S.naturalWidth+" Ã— "+S.naturalHeight+")"},M=void 0;return Q(e,gIc,ab,{once:!0}),this.viewing={abort:function(){P(e,gIc,ab),c.complete?this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort():(P(c,eY,M),this.timeout&&clearTimeout(this.timeout))}},c.complete?this.load():(Q(c,eY,M=this.load.bind(this),{once:!0}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){E(c,J),f.timeout=!1},1e3)),this},prev:function(){var f=0<arguments.length&&void 0!==arguments[0]&&arguments[0],S=this.index-1;return S<0&&(S=f?this.length-1:0),this.view(S),this},next:function(){var f=0<arguments.length&&void 0!==arguments[0]&&arguments[0],S=this.length-1,e=this.index+1;return S<e&&(e=f?0:S),this.view(e),this},move:function(f,S){var e=this.imageData;return this.moveTo(s(f)?f:e.left+Number(f),s(S)?S:e.top+Number(S)),this},moveTo:function(f){var S=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f,e=this.imageData;if(f=Number(f),S=Number(S),this.viewed&&!this.played&&this.options.movable){var j=!1;r(f)&&(e.left=f,j=!0),r(S)&&(e.top=S,j=!0),j&&this.renderImage()}return this},zoom:function(f){var S=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,j=this.imageData;return f=(f=Number(f))<0?1/(1-f):1+f,this.zoomTo(j.width*f/j.naturalWidth,S,e),this},zoomTo:function(f){var S,e,j,d,D,dA=1<arguments.length&&void 0!==arguments[1]&&arguments[1],b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,h=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=this.options,X=this.pointers,c=this.imageData;if(r(f=Math.max(0,f))&&this.viewed&&!this.played&&(h||a.zoomable)){if(!h){var ab=Math.max(.01,a.minZoomRatio),M=Math.min(100,a.maxZoomRatio);f=Math.min(Math.max(f,ab),M)}b&&.95<f&&f<1.05&&(f=1);var eL=c.naturalWidth*f,g=c.naturalHeight*f;if(b){var bd=(d=this.viewer,{left:(D=d.getBoundingClientRect()).left+(window.pageXOffset-document.documentElement.clientLeft),top:D.top+(window.pageYOffset-document.documentElement.clientTop)}),J=X&&Object.keys(X).length?(j=e=S=0,x(X,function(f){var d=f.startX,D=f.startY;S+=d,e+=D,j+=1}),{pageX:S/=j,pageY:e/=j}):{pageX:b.pageX,pageY:b.pageY};c.left-=(eL-c.width)*((J.pageX-bd.left-c.left)/c.width),c.top-=(g-c.height)*((J.pageY-bd.top-c.top)/c.height)}else c.left-=(eL-c.width)/2,c.top-=(g-c.height)/2;c.width=eL,c.height=g,c.ratio=f,this.renderImage(),dA&&this.tooltip()}return this},rotate:function(f){return this.rotateTo((this.imageData.rotate||0)+Number(f)),this},rotateTo:function(f){var S=this.imageData;return r(f=Number(f))&&this.viewed&&!this.played&&this.options.rotatable&&(S.rotate=f,this.renderImage()),this},scaleX:function(f){return this.scale(f,this.imageData.scaleY),this},scaleY:function(f){return this.scale(this.imageData.scaleX,f),this},scale:function(f){var S=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f,e=this.imageData;if(f=Number(f),S=Number(S),this.viewed&&!this.played&&this.options.scalable){var j=!1;r(f)&&(e.scaleX=f,j=!0),r(S)&&(e.scaleY=S,j=!0),j&&this.renderImage()}return this},play:function(){var f=this,S=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(!this.isShown||this.played)return this;var e=this.options,j=this.player,d=this.loadImage.bind(this),D=[],dA=0,b=0;if(this.played=!0,this.onLoadWhenPlay=d,S&&this.requestFullscreen(),C(j,gI),x(this.items,function(f,S){var X=f.querySelector("img"),c=document.createElement("img");c.src=I(X,"originalUrl"),c.alt=X.getAttribute("alt"),dA+=1,C(c,a),F(c,ei,e.transition),B(f,h)&&(C(c,bd),b=S),D.push(c),Q(c,eY,d,{once:!0}),j.appendChild(c)}),r(e.interval)&&0<e.interval){var X=function S(){f.playing=setTimeout(function(){E(D[b],bd),C(D[b=(b+=1)<dA?b:0],bd),S()},e.interval)};1<dA&&X()}return this},stop:function(){var f=this;if(!this.played)return this;var S=this.player;return this.played=!1,clearTimeout(this.playing),x(S.getElementsByTagName("img"),function(S){P(S,eY,f.onLoadWhenPlay)}),E(S,gI),S.innerHTML="",this.exitFullscreen(),this},full:function(){var f=this,S=this.options,e=this.viewer,j=this.image,d=this.list;return!this.isShown||this.played||this.fulled||!S.inline||(this.fulled=!0,this.open(),C(this.button,c),S.transition&&(E(d,ei),this.viewed&&E(j,ei)),C(e,X),e.setAttribute("style",""),A(e,{zIndex:S.zIndex}),this.initContainer(),this.viewerData=y({},this.containerData),this.renderList(),this.viewed&&this.initImage(function(){f.renderImage(function(){S.transition&&setTimeout(function(){C(j,ei),C(d,ei)},0)})})),this},exit:function(){var f=this,S=this.options,e=this.viewer,j=this.image,d=this.list;return this.isShown&&!this.played&&this.fulled&&S.inline&&(this.fulled=!1,this.close(),E(this.button,c),S.transition&&(E(d,ei),this.viewed&&E(j,ei)),E(e,X),A(e,{zIndex:S.zIndexInline}),this.viewerData=y({},this.parentData),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){f.renderImage(function(){S.transition&&setTimeout(function(){C(j,ei),C(d,ei)},0)})})),this},tooltip:function(){var f=this,S=this.options,e=this.tooltipBox,j=this.imageData;return this.viewed&&!this.played&&S.tooltip&&(e.textContent=Math.round(100*j.ratio)+"%",this.tooltipping?clearTimeout(this.tooltipping):S.transition?(this.fading&&R(e,i),C(e,gI),C(e,a),C(e,ei),e.offsetWidth,C(e,bd)):C(e,gI),this.tooltipping=setTimeout(function(){S.transition?(Q(e,i,function(){E(e,gI),E(e,a),E(e,ei),f.fading=!1},{once:!0}),E(e,bd),f.fading=!0):E(e,gI),f.tooltipping=!1},1e3)),this},toggle:function(){return 1===this.imageData.ratio?this.zoomTo(this.initialImageData.ratio,!0):this.zoomTo(1,!0),this},reset:function(){return this.viewed&&!this.played&&(this.imageData=y({},this.initialImageData),this.renderImage()),this},update:function(){var f=this.element,S=this.options,e=this.isImg;if(e&&!f.parentNode)return this.destroy();var j=[];if(x(e?[f]:f.querySelectorAll("img"),function(f){S.filter?S.filter(f)&&j.push(f):j.push(f)}),!j.length)return this;if(this.images=j,this.length=j.length,this.ready){var d=[];if(x(this.items,function(f,S){var e=f.querySelector("img"),D=j[S];D?D.src!==e.src&&d.push(S):d.push(S)}),A(this.list,{width:"auto"}),this.initList(),this.isShown)if(this.length){if(this.viewed){var D=d.indexOf(this.index);0<=D?(this.viewed=!1,this.view(Math.max(this.index-(D+1),0))):C(this.items[this.index],h)}}else this.image=null,this.viewed=!1,this.index=0,this.imageData=null,this.canvas.innerHTML="",this.title.innerHTML=""}else this.build();return this},destroy:function(){var f=this.element,S=this.options;return I(f,d)&&(this.destroyed=!0,this.ready?(this.played&&this.stop(),S.inline?(this.fulled&&this.exit(),this.unbind()):this.isShown?(this.viewing&&(this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort()),this.hiding&&this.transitioning.abort(),this.hidden()):this.showing&&(this.transitioning.abort(),this.hidden()),this.ready=!1,this.viewer.parentNode.removeChild(this.viewer)):S.inline&&(this.delaying?this.delaying.abort():this.initializing&&this.initializing.abort()),S.inline||P(f,dg,this.onStart),function(f,S){if(t(f[S]))try{delete f[S]}catch(e){f[S]=void 0}else if(f.dataset)try{delete f.dataset[S]}catch(e){f.dataset[S]=void 0}else f.removeAttribute("data-"+H(S))}(f,d)),this}},Sf={open:function(){var f=this.body;C(f,fj),f.style.paddingRight=this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0)+"px"},close:function(){var f=this.body;E(f,fj),f.style.paddingRight=this.initialBodyPaddingRight},shown:function(){var f=this.element,S=this.options;this.fulled=!0,this.isShown=!0,this.render(),this.bind(),this.showing=!1,w(S.shown)&&Q(f,cN,S.shown,{once:!0}),!1!==R(f,cN)&&this.ready&&this.isShown&&!this.hiding&&this.view(this.index)},hidden:function(){var f=this.element,S=this.options;this.fulled=!1,this.viewed=!1,this.isShown=!1,this.close(),this.unbind(),C(this.viewer,ab),this.resetList(),this.resetImage(),this.hiding=!1,this.destroyed||(w(S.hidden)&&Q(f,eE,S.hidden,{once:!0}),R(f,eE))},requestFullscreen:function(){var f=this.element.ownerDocument;if(this.fulled&&!f.fullscreenElement&&!f.mozFullScreenElement&&!f.webkitFullscreenElement&&!f.msFullscreenElement){var S=f.documentElement;S.requestFullscreen?S.requestFullscreen():S.msRequestFullscreen?S.msRequestFullscreen():S.mozRequestFullScreen?S.mozRequestFullScreen():S.webkitRequestFullscreen&&S.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){if(this.fulled){var f=this.element.ownerDocument;f.exitFullscreen?f.exitFullscreen():f.msExitFullscreen?f.msExitFullscreen():f.mozCancelFullScreen?f.mozCancelFullScreen():f.webkitExitFullscreen&&f.webkitExitFullscreen()}},change:function(f){var S,e,j,d=this.options,h=this.pointers,a=h[Object.keys(h)[0]],X=a.endX-a.startX,c=a.endY-a.startY;switch(this.action){case D:this.move(X,c);break;case b:this.zoom((e=y({},S=h),j=[],x(S,function(f,S){delete e[S],x(e,function(S){var e=Math.abs(f.startX-S.startX),d=Math.abs(f.startY-S.startY),D=Math.abs(f.endX-S.endX),dA=Math.abs(f.endY-S.endY),b=Math.sqrt(e*e+d*d),h=(Math.sqrt(D*D+dA*dA)-b)/b;j.push(h)})}),j.sort(function(f,S){return Math.abs(f)<Math.abs(S)}),j[0]),!1,f);break;case dA:this.action="switched",this.pointers={},Math.abs(X)>Math.abs(c)&&(1<X?this.prev(d.loop):X<-1&&this.next(d.loop))}x(h,function(f){f.startX=f.endX,f.startY=f.endY})},isSwitchable:function(){var f=this.imageData,S=this.viewerData;return 1<this.length&&0<=f.left&&0<=f.top&&f.width<=S.width&&f.height<=S.height}},ef=j.Viewer,jf=function(){function f(e){var j=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(n(this,f),!e||1!==e.nodeType)throw new Error("The first argument is required and must be an element.");this.element=e,this.options=y({},S,v(j)&&j),this.action=!1,this.fading=!1,this.fulled=!1,this.hiding=!1,this.index=0,this.isImg=!1,this.length=0,this.played=!1,this.playing=!1,this.pointers={},this.ready=!1,this.showing=!1,this.timeout=!1,this.tooltipping=!1,this.viewed=!1,this.viewing=!1,this.isShown=!1,this.wheeling=!1,this.init()}return o(f,[{key:"init",value:function(){var f=this,S=this.element,e=this.options;if(!I(S,d)){K(S,d,this);var j="img"===S.tagName.toLowerCase(),D=[];if(x(j?[S]:S.querySelectorAll("img"),function(S){w(e.filter)?e.filter.call(f,S)&&D.push(S):D.push(S)}),D.length){this.isImg=j,this.length=D.length,this.images=D;var dA=S.ownerDocument,b=dA.body||dA.documentElement;if(this.body=b,this.scrollbarWidth=window.innerWidth-dA.documentElement.clientWidth,this.initialBodyPaddingRight=window.getComputedStyle(b).paddingRight,s(document.createElement(d).style.transition)&&(e.transition=!1),e.inline){var h=0,a=function(){if((h+=1)===f.length){var S=void 0;f.initializing=!1,f.delaying={abort:function(){clearTimeout(S)}},S=setTimeout(function(){f.delaying=!1,f.build()},0)}};this.initializing={abort:function(){x(D,function(f){f.complete||P(f,eY,a)})}},x(D,function(f){f.complete?a():Q(f,eY,a,{once:!0})})}else Q(S,dg,this.onStart=function(S){var e=S.target;"img"===e.tagName.toLowerCase()&&f.view(f.images.indexOf(e))})}}}},{key:"build",value:function(){if(!this.ready){var f=this.element,S=this.options,e=f.parentNode,j=document.createElement("div");j.innerHTML='<div class="viewer-container" touch-action="none"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><div class="viewer-toolbar"></div><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div role="button" class="viewer-button" data-action="mix"></div><div class="viewer-player"></div></div>';var D=j.querySelector("."+d+"-container"),dA=D.querySelector("."+d+"-title"),b=D.querySelector("."+d+"-toolbar"),h=D.querySelector("."+d+"-navbar"),c=D.querySelector("."+d+"-button"),M=D.querySelector("."+d+"-canvas");if(this.parent=e,this.viewer=D,this.title=dA,this.toolbar=b,this.navbar=h,this.button=c,this.canvas=M,this.footer=D.querySelector("."+d+"-footer"),this.tooltipBox=D.querySelector("."+d+"-tooltip"),this.player=D.querySelector("."+d+"-player"),this.list=D.querySelector("."+d+"-list"),C(dA,S.title?W(S.title):ab),C(h,S.navbar?W(S.navbar):ab),F(c,ab,!S.button),S.backdrop&&(C(D,d+"-backdrop"),S.inline||!0!==S.backdrop||K(M,"action","hide")),S.toolbar){var eL=document.createElement("ul"),g=v(S.toolbar),bd=l.slice(0,3),eT=l.slice(7,9),fj=l.slice(9);g||C(b,W(S.toolbar)),x(g?S.toolbar:l,function(f,e){var j=g&&v(f),D=g?H(e):f,dA=j&&!s(f.show)?f.show:f;if(dA&&(S.zoomable||-1===bd.indexOf(D))&&(S.rotatable||-1===eT.indexOf(D))&&(S.scalable||-1===fj.indexOf(D))){var b=j&&!s(f.size)?f.size:f,h=j&&!s(f.click)?f.click:f,a=document.createElement("li");a.setAttribute("role","button"),C(a,d+"-"+D),w(h)||K(a,"action",D),r(dA)&&C(a,W(dA)),-1!==["small","large"].indexOf(b)?C(a,d+"-"+b):"play"===D&&C(a,d+"-large"),w(h)&&Q(a,dg,h),eL.appendChild(a)}}),b.appendChild(eL)}else C(b,ab);if(!S.rotatable){var gI=b.querySelectorAll('li[class*="rotate"]');C(gI,J),x(gI,function(f){b.appendChild(f)})}if(S.inline)C(c,"viewer-fullscreen"),A(D,{zIndex:S.zIndexInline}),"static"===window.getComputedStyle(e).position&&A(e,{position:"relative"}),e.insertBefore(D,f.nextSibling);else{C(c,"viewer-close"),C(D,X),C(D,a),C(D,ab),A(D,{zIndex:S.zIndex});var ei=S.container;p(ei)&&(ei=f.ownerDocument.querySelector(ei)),ei||(ei=this.body),ei.appendChild(D)}S.inline&&(this.render(),this.bind(),this.isShown=!0),this.ready=!0,w(S.ready)&&Q(f,fD,S.ready,{once:!0}),!1!==R(f,fD)?this.ready&&S.inline&&this.view():this.ready=!1}}}],[{key:"noConflict",value:function(){return window.Viewer=ef,f}},{key:"setDefaults",value:function(f){y(S,v(f)&&f)}}]),f}();if(y(jf.prototype,Z,$,_,ff,Sf),f.fn){var df=f.fn.viewer,Df="viewer";f.fn.viewer=function(S){for(var e=arguments.length,j=Array(1<e?e-1:0),d=1;d<e;d++)j[d-1]=arguments[d];var D=void 0;return this.each(function(e,d){var dA=f(d),b="destroy"===S,h=dA.data(Df);if(!h){if(b)return;var a=f.extend({},dA.data(),f.isPlainObject(S)&&S);h=new jf(d,a),dA.data(Df,h)}if("string"==typeof S){var X=h[S];f.isFunction(X)&&((D=X.apply(h,j))===h&&(D=void 0),b&&dA.removeData(Df))}}),void 0!==D?D:this},f.fn.viewer.Constructor=jf,f.fn.viewer.setDefaults=jf.setDefaults,f.fn.viewer.noConflict=function(){return f.fn.viewer=df,this}}});